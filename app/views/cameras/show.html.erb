<!-- app/views/cameras/show.html.erb -->
<h2><%= @camera.name %> - <%= @camera.location %></h2>

<video id="video" class="video-js vjs-default-skin" controls autoplay width="720" height="420"></video>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
  var video = document.getElementById('video');
  var url = "<%= @camera.stream_url %>";

  if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource(url);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, function() {
      video.play();
    });
  } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = url;
    video.addEventListener('loadedmetadata', function() {
      video.play();
    });
  }
</script>

<%= link_to "Back", cameras_path %>
